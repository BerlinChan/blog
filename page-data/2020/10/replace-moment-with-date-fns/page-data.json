{"componentChunkName":"component---src-templates-post-template-js","path":"/2020/10/replace-moment-with-date-fns/","result":{"data":{"markdownRemark":{"id":"4f6c4984-562a-5204-afc7-a27203457853","html":"<!-- endExcerpt -->\n<p>看到新闻 <a href=\"https://society.solidot.org/story?sid=65553\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Moment.js 宣布进入遗留状态</a> 的当天觉得挺惊奇，没想到这一天这么快就到来，不禁感叹前端开发、Javascript 世界变化之快以及高效。到 <a href=\"https://momentjs.com/docs/#/-project-status/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Moment.js 官网</a>看了声明，很清楚的说明项目的情况和考虑，前面一部分翻译如下：</p>\n<hr>\n<h2 id=\"项目状态\" style=\"position:relative;\"><a href=\"#%E9%A1%B9%E7%9B%AE%E7%8A%B6%E6%80%81\" aria-label=\"项目状态 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>项目状态</h2>\n<p>Moment.js 已被数百万个项目运用，我们为在 Web 上更好使用时间日期作出贡献而感到高兴。截至 2020年9月，Moment 每周的下载量超过 1200万！然而，Moment 是为 JavaScript 生态系统的上一个时代构建的。如今的现代 Web 看起来已大不相同。这些年来，Moment 有所发展，但其设计基本上与 2011年创建时相同。鉴于有众多项目依赖它，我们选择优先考虑稳定性而不是新功能。</p>\n<p>例如，Moment 对象是可变的。这是有关 Moment 的常见抱怨来源。我们在<a href=\"https://momentjs.com/guides/#/lib-concepts/mutability/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">使用指南</a>中提到了该问题，但仍给大多数新用户带来意外困扰。对于每个使用 Moment 的项目，更改为不可变对象将是一项重大的断层式更新。创建不可变的 “Moment v3” 将是一项艰巨的任务，并将使 Moment 完全成为一个不同的库。由于这已在其他库中完成，因此我们认为保留可变的 API 更为重要。</p>\n<p>在现代应用程序中针对 Moment 的另外一个问题是他的大小。Moment 在流行的 “tree shaking” 算法中工作的不太好，导致 Web 应用程序包的曾大。若需要国际化或时区支持，Moment 会非常大（译注：当前的 v2.29.0 官网上显示 moment.min.js gz压缩后为 18.2k，moment-with-locales.js gz压缩则增至 73.2k）。现代 Web浏览器（和 Node.js）通过规范编号为 <a href=\"https://ecma-international.org/ecma-402/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ECMA-402</a> 的<a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Intl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">Intl</code></a> 对象暴露对国际化和时区支持。<a href=\"https://moment.github.io/luxon/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Luxon</a> 等其他库利用这一优势，减少或取消自己提供数据文件的需要。</p>\n<p>最近，Chrome 开发工具<a href=\"https://twitter.com/addyosmani/status/1304676118822174721\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">开始因其大小而建议替换掉 Moment</a>。我们普遍支持这一举措。</p>\n<p>你可能想阅读：</p>\n<ul>\n<li><a href=\"https://dockyard.com/blog/2020/02/14/you-probably-don-t-need-moment-js-anymore\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">你可能不再需要 Moment.js</a></li>\n<li><a href=\"https://github.com/you-dont-need/You-Dont-Need-Momentjs/blob/master/README.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">你（可能）不需要 Moment.js</a></li>\n<li><a href=\"https://inventi.studio/en/blog/why-you-shouldnt-use-moment-js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">为什么你不应该用 Moment.js</a></li>\n<li><a href=\"https://blog.logrocket.com/4-alternatives-to-moment-js-for-internationalizing-dates/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">4 个日期国际化的 moment.js 替代品</a></li>\n</ul>\n<p>Moment 团队已详细讨论了这些问题。我们认识到许多现有项目可能会继续使用 Moment，但是我们不鼓励在以后的新项目中使用。作为替换，我们推荐当今在现代应用中使用的<a href=\"https://momentjs.com/docs/#/-project-status/recommendations/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">绝佳选择</a>。我们还想推广 JavaScript 的 <a href=\"https://momentjs.com/docs/#/-project-status/future/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">Temporal</code></a> 新增提案，该功能正在寻求反馈和贡献者。</p>\n<p><em>我们认定 Moment 现在是处于维护模式下的遗留项目。他并没有死，但他确实已完成使命。</em></p>\n<p>这意味着：</p>\n<ul>\n<li>不再添加新功能特性。</li>\n<li>不再修改 Moment 的 API 为不可变对象。</li>\n<li>不再解决 tree shaking 和包大小问题。</li>\n<li>不再有大版本更新（没有 version 3）。</li>\n<li>可能不再修正 bug，特别是较久远的问题。</li>\n</ul>\n<p>对于 Moment 国际化语言文件：</p>\n<ul>\n<li>我们可能不接受对区域设置字符串或本地化日期格式的修正，特别是在它们的当前形式已经被成功地论证过的情况下。</li>\n<li>您必须使用重要的，非轶事证据来为地区变更提出新的令人信服的论据，以支持您的立场。</li>\n<li>如果您要更改的字符串或格式反映在 <a href=\"http://cldr.unicode.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CLDR</a> 中，那么您必须首先在此处提交更改并接受它。</li>\n</ul>\n<p>但由于 Moment 已在数百万个现有项目中使用：</p>\n<ul>\n<li>当出现严重安全问题时，我们将予以解决。</li>\n<li>在 <a href=\"https://www.iana.org/time-zones\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">IANA时区数据库</a> 发布后更新 Moment-Timezone 的数据。</li>\n</ul>\n<hr>\n<h2 id=\"替代品\" style=\"position:relative;\"><a href=\"#%E6%9B%BF%E4%BB%A3%E5%93%81\" aria-label=\"替代品 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>替代品</h2>\n<p><a href=\"https://momentjs.com/docs/#/-project-status/recommendations/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">官方推荐</a>如下几个库：</p>\n<ul>\n<li><a href=\"https://moment.github.io/luxon/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Luxon</a></li>\n<li><a href=\"https://day.js.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Day.js</a></li>\n<li><a href=\"https://date-fns.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">date-fns</a></li>\n<li><a href=\"https://js-joda.github.io/js-joda/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">js-Joda</a></li>\n</ul>\n<p>我建议你去每个库的官网看看他们各自的特色和优点，然后再决定选择哪个作为替代。</p>\n<p><em>其中 <a href=\"https://moment.github.io/luxon/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Luxon</a> 的作者是 Moment 长期贡献者 <a href=\"https://github.com/icambron\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Isaac Cambron</a>，算是 Moment 的灵魂续作。<a href=\"https://day.js.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Day.js</a> 有着与 Moment 类似的 API，快速替换的好选择。<a href=\"https://date-fns.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">date-fns</a> 遵循函数式编程规范，直接操作 JS Date 对象，这是我的首选。</em></p>\n<h2 id=\"我与-moment-的故事\" style=\"position:relative;\"><a href=\"#%E6%88%91%E4%B8%8E-moment-%E7%9A%84%E6%95%85%E4%BA%8B\" aria-label=\"我与 moment 的故事 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>我与 Moment 的故事</h2>\n<p><a href=\"/2016/12/why-quit-media-field/\">2015下半年转行 Web 开发</a>的第一份工作中，首次看到同事使用 Moment 后，我就对他<a href=\"https://momentjs.com/docs/#/displaying/format/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">格式化日期操作</a>的便利性所吸引（不用再 getFullYear, getMonth …），然后被我运用到各种不同项目中。</p>\n<p>上面提到的可变对象问题，今年在公司一个可视化大屏项目中，确实令我困扰了一下，直到我反复试验后才注意到 <a href=\"https://momentjs.com/docs/#/manipulating/add/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">add()</code></a> 操作后可变对象的问题。不过这只是一个小插曲而已，仍然要感谢 Moment 在这段时间中给我开发所带来的便利和愉悦。</p>\n<p>Moment 的发展现状正是 Javascript 生态<em>增长且发展</em>的一个正面例子，是当今热门词汇<a href=\"https://youtu.be/nURtMLCanp0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><em>内卷化</em></a>的一个反面例证。</p>","excerpt":"","fields":{"slug":"/2020/10/replace-moment-with-date-fns","categorySlugs":["/category/前端/"],"tagSlugs":["/tag/moment-js/","/tag/内卷化/"]},"frontmatter":{"title":"Moment.js 使命完成，替代品推荐","date":"2020-10-02T10:46:37.121Z","categories":["前端"],"description":"流行 JS 时间日期库 Moment.js 宣布进入维护模式，他已完成属于他时代的使命。本文翻译官方声明的开头部分，推荐替代品，并向他表示我的感谢。","tags":["Moment.js","内卷化"],"slug":"/2020/10/replace-moment-with-date-fns","featured_media":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHSq0GEB//EABgQAAIDAAAAAAAAAAAAAAAAAAECABIg/9oACAEBAAEFAmJlnz//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAAASAhMf/aAAgBAQAGPwKkYo//xAAYEAACAwAAAAAAAAAAAAAAAAABEQAgcf/aAAgBAQABPyEFKOwVb//aAAwDAQACAAMAAAAQMA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEAAQQDAAAAAAAAAAAAAAABABEhMUEQgeH/2gAIAQEAAT8QT2takm1ToXF7fINuDMMT/9k="},"images":{"fallback":{"src":"/static/e74cb1d0ee5a1772a8d9bc442cdc43c0/e737e/featured_media.jpg","srcSet":"/static/e74cb1d0ee5a1772a8d9bc442cdc43c0/e737e/featured_media.jpg 800w","sizes":"800px"},"sources":[{"srcSet":"/static/e74cb1d0ee5a1772a8d9bc442cdc43c0/e7773/featured_media.webp 800w","type":"image/webp","sizes":"800px"}]},"width":800,"height":400}}}}},"prevPost":{"fields":{"slug":"/2020/07/upgrade-old-hp-compaq-v3000-notebook"},"frontmatter":{"title":"升级 07 年的 HP Compaq v3000 笔记本电脑"}},"nextPost":{"fields":{"slug":"/2020/10/why-i-love-classical-music"},"frontmatter":{"title":"我为什么喜欢古典音乐"}}},"pageContext":{"slug":"/2020/10/replace-moment-with-date-fns","prevPostSlug":"/2020/07/upgrade-old-hp-compaq-v3000-notebook","nextPostSlug":"/2020/10/why-i-love-classical-music"}},"staticQueryHashes":["2727970573","3709504828","4110059069"],"slicesMap":{}}