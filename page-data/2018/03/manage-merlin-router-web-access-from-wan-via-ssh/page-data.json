{"componentChunkName":"component---src-templates-post-archived-blog-template-js","path":"/2018/03/manage-merlin-router-web-access-from-wan-via-ssh/","result":{"data":{"archivedBlogPostJson":{"categories":[{"path":"/category/pcandinternet/","name":"计算机与网络"}],"tags":[{"name":"Merlin","path":"/tag/merlin/"},{"name":"网络安全","path":"/tag/cyber-security/"},{"name":"路由","path":"/tag/route/"},{"name":"配置","path":"/tag/configration/"}],"featured_media":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLklEQVR42mOwnlBmqq5tZmVpZmFuZmFhZmkBYhAHGKCagRqMjM0Mjcz0jcyMTIjXXG6qpmXu7GAe4GkR4m0RHWDu6WJmampmYgomTUCkGZCNTbPNpAoTGRXrljy79b2263vtTi20XdkBdIK5g62ZlYWZvY2ZuTlIv7k5ds2mCmpWJcnmPm7mPq5mWnpWJSnmjnY2kyutW/NsptdYNWTbzKqzCPcz0zNAMwKmuSjJwtfNMjsGKARkA621WdBkM7/JdnWXzew62+XtFjGBproGaGEJ1iyvalWRalWcZJkRZVWcbN2cCwx2cyc7czsbc2d7M2tLkH3AWDDFHmDaQKss/D3M/dwt/DxAGoChBQxzYxNQFEDCzNQUV1TpgDxjYARFkKgyJz6ega4yN4MiogEAyeWVVkopv+kAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/53bdfa2908cf11e400fc2328025b2b9a/ed3fb/SSH-on-Windows-Featured.png","srcSet":"/static/53bdfa2908cf11e400fc2328025b2b9a/ed3fb/SSH-on-Windows-Featured.png 800w","sizes":"800px"},"sources":[{"srcSet":"/static/53bdfa2908cf11e400fc2328025b2b9a/e7773/SSH-on-Windows-Featured.webp 800w","type":"image/webp","sizes":"800px"}]},"width":800,"height":400}}},"path":"/2018/03/manage-merlin-router-web-access-from-wan-via-ssh/","date":"2018-03-13T09:12:11.000Z","excerpt":"我的路由器是Asus RT-AC68U，固件版本Merlin 380.69_2-X7.8。 相比密码，通过SS … ","title":"通过SSH开闭Merlin路由远程管理页","content":"<p>我的路由器是<strong>Asus RT-AC68U</strong>，固件版本<strong>Merlin 380.69_2-X7.8</strong>。</p>\n<p>相比密码，通过SSH key远程登陆更为安全。有时为方便操作需要远程访问路由Web界面，但将路由设置界面暴露到公网也加大了安全风险，所以我的做法是SSH连接一直开放，需要远程访问Web界面时，通过SSH打开，用完后立刻关闭。<!--more--></p>\n<p>开始之前需要路由有公网IP、配置DDNS、配置SSHd，然后就可以开闭远程管理页了：</p>\n<ol>\n<li>在内网通过Web界面<a href=\"https://www.asus.com/support/FAQ/1000926/\" target=\"_blank\" rel=\"noopener\">设置远程管理</a>，并测试通过</li>\n<li>SSH登陆，使用nvram命令关闭远程管理页\n<pre class=\"brush: plain; title: ; notranslate\" title=\"\">\r\nnvram set misc_http_x=0\r\nnvram commit\r\nreboot\r\n</pre>\n</li>\n<li>Done</li>\n</ol>\n<p>上面的操作就将远程管理页关掉了，上面的misc_http_x设置为1即打开。</p>\n<p>为加固安全性，可以启用HTTPS访问，并为路由配置证书，参考：<a href=\"http://koolshare.cn/thread-79146-1-1.html\" target=\"_blank\" rel=\"noopener\">搞定Merlin使用DNS实现Let&#8217;s Encrpt证书，使用SSL安全访问后台</a></p>\n<p>除开闭远程管理，还可通过nvram命令可以完全控制路由设置（后面补充字段对应功能寻找方法），参考：<a href=\"https://mycyberuniverse.com/linux/full-controling-the-asus-router-via-command-line.html\" target=\"_blank\" rel=\"noopener\">Full controlling the ASUS router via command line</a>，该文中的flash命令替换为nvram</p>\n<hr />\n<p><em>后来我发现，直接开Merlin里面的OpenVPN server，远程连VPN更安全、省事。</em></p>\n<h4><span style=\"color: #0000ff;\"><em>补充：</em></span></h4>\n<p>到路由器设置页面，快捷键Ctrl+Shift+C定位要设置的功能表单，例如“从互联网设置 RT-AC68U”的“是/否”选项，在浏览器控制台中定位如下行代码</p>\n<pre class=\"brush: xml; title: ; notranslate\" title=\"\">\r\n&lt; input name=&quot;misc_http_x&quot; type=&quot;radio&quot; value=&quot;1&quot; /&gt;\r\n</pre>\n<p>其中name就是字段名，value就是值</p>\n"}},"pageContext":{"slug":"/2018/03/manage-merlin-router-web-access-from-wan-via-ssh/"}},"staticQueryHashes":["2727970573","3709504828","4110059069"],"slicesMap":{}}