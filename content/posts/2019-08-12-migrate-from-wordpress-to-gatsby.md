---
title: åšå®¢ä» Wordpress è¿ç§»åˆ° Gatsby
date: "2019-08-12T10:46:37.121Z"
template: "post"
featured_top: false
featured_media: "../../static/media/2019/08/wordpress-to-gatsby.png"
draft: false
slug: "/2019/08/migrate-from-wordpress-to-gatsby"
category: "å‰ç«¯"
tags:
    - "è¿ç§»"
    - "blog"
    - "Gatsby"
    - "Wordpress"
description: "åˆ©ç”¨ Wordpress æ’ä»¶ WP2Static å°†å†…å®¹é™æ€åŒ–æˆ HTMLï¼Œç„¶ååˆ©ç”¨æ’ä»¶ gatsby-source-wordpress æä¾›çš„æ•°æ®ï¼Œä¸ºæ—§ blog å†…å®¹ç”Ÿæˆç›®å½•ï¼Œå¹¶è¿æ¥åˆ°é™æ€åŒ–åçš„ HTML"
---

<!-- endExcerpt -->

ä¹‹å‰[ä¸ºä»€ä¹ˆå¼ƒç”¨WordPresså¹¶æ¬ç¦»é˜¿é‡Œäº‘](https://www.berlinchan.com/2019/08/why-leave-wordpress-and-aliyun/)ä¸­è®°çš„ä¸‰ç‚¹é—®é¢˜ï¼Œ
å¯¼è‡´æˆ‘å†³å®šè¿ç§»ç½‘ç«™ï¼Œå¼ƒç”¨ Wordpress çš„æ›¿ä»£æ–¹æ¡ˆæ¯”è¾ƒè¿‡ Jekyll/Hexo/Gatsby ä¸‰ç§æ¡†æ¶ã€‚

- Jekyllï¼Œè™½ç„¶æ˜¯ GitHub Pages å®˜æ–¹æ”¯æŒçš„é™æ€å†…å®¹ç”Ÿæˆæ¡†æ¶ï¼Œä½†æ˜¯æˆ‘å¯¹ Ruby è¯­è¨€ä¸ç†Ÿæ‚‰ï¼Œæ‰€ä»¥é¦–å…ˆæ’é™¤ã€‚
- Hexoï¼Œä¸Šæ‰‹å®¹æ˜“æœ‰å¾ˆå¤šä¸­æ–‡æ•™ç¨‹ï¼Œä½†æ˜¯æ–‡æ¡£å†™çš„ä¸å¥½ï¼Œå¾ˆå¤š API è¯´æ˜ä¸å®¹æ˜“æ‰¾åˆ°ï¼Œä¸è¿‡ StackOverflow ä¸Šæœ‰å¾ˆå¤šçƒ­å¿ƒäººçš„è¡¥å……ã€‚
    æˆ‘è¯•ç€ç”¨ Hexo æ­å»º[æ—§ç«™åšç‰©é¦†](https://museum.berlinchan.com)ï¼ŒæœŸé—´ä¸å–œæ¬¢ä¸»é¢˜ä¸­çš„æ¨¡æ¿å¼•æ“è¯­æ³•ã€‚
- Gatsbyï¼Œæ˜¯æˆ‘è¿ç§»çš„é€‰æ‹©ã€‚åŸºäº React ä¼˜é›…çš„ç»„ä»¶æ„å»ºï¼Œæ—¢èƒ½è½»æ¾æ­ä¸Š SPA PWA çš„ç°ä»£åŒ–ä¾¿è½¦ï¼Œä¹Ÿé¡ºä¾¿åœ¨è¿ç§»ä¸­æ„Ÿå—ä¸€ä¸‹ GraphQLã€‚

## è¿ç§»å·¥ä½œ
è¿ç§»çš„å‰ææ˜¯**ä¿è¯æ—§åšå®¢å†…å®¹è®¿é—®æ­£å¸¸**ï¼Œæœ€åæ–¹æ¡ˆå¯åˆ†ä¸ºä¸¤éƒ¨åˆ†å·¥ä½œï¼š

1. è„±ç¦» Wordpress ç¨‹åºï¼Œå°†æ—§æ–‡ç« ç”Ÿæˆä¸ºé™æ€æ–‡ä»¶
2. æ­å»ºæ–°ç«™ï¼Œå°†æ—§æ–‡ç« ä¿æŒåŸæ¥è·¯å¾„çš„å¯¼å…¥åˆ°æ–°ç«™

ç¬¬ä¸€æ­¥è„±ç¦» Wordpress ç¨‹åºï¼Œæˆ‘ç”¨æ’ä»¶ WP2Static å°†æ•´ç«™ç”Ÿæˆä¸ºé™æ€ HTML æ–‡ä»¶ï¼Œæ³¨æ„ç”Ÿæˆå‰å…ˆå°†è¯„è®ºå’Œä¸å¿…è¦çš„æ’ä»¶å…³æ‰ï¼Œ
æˆ‘çš„é˜¿é‡Œäº‘è™šä¸»æœºå…¨å¤©å¤„äºåŠæ­»çš„çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘å°†æ–‡ä»¶å’Œæ•°æ®åº“æ”¾åˆ°æœ¬åœ°çš„ WAMP ç¯å¢ƒä¸­è¿è¡Œï¼Œ
è°ƒå¤§å†…å­˜åï¼Œå‰©ä¸‹å·¥ä½œè¿™ä¸ªæ’ä»¶åšçš„å·²ç»å¾ˆå¥½äº†ï¼Œæœ‰æ—¶å€™ç”Ÿæˆé”™è¯¯å¤šè¯•å‡ æ¬¡å°±å¥½ã€‚

ç”Ÿæˆçš„é™æ€ HTML é¡µé¢ä¸­æœ‰å¾ˆå¤šå†—ä½™çš„ SVG å›¾æ ‡æ•°æ®ï¼Œè¿˜æœ‰å…¶ä»–å†—ä½™çš„æ ‡ç­¾ï¼Œå¯ä»¥æ‰¹å¤„ç†ç²¾ç®€æ‰ï¼Œ
å¦å¤–æ‰¹é‡æ›¿æ¢ URL ä¸ºå­˜æ¡£åœ°å€ï¼Œæœ€åéƒ¨ç½²åˆ° GitHub Pagesã€‚

## åŸºäº Gatsby æ­å»ºæ–°ç«™
Gatsby æœ‰å¾ˆå¤š [starter é¡¹ç›®](https://www.gatsbyjs.org/starters/)ï¼Œæœ€åˆæˆ‘ç”¨[gatsby-starter-lumen](https://github.com/alxshelepenok/gatsby-starter-lumen)ä½œä¸º starter å¼€å§‹çš„ï¼Œ
å®ƒé›†æˆäº†æˆ‘ä¸å‡†å¤‡ä½¿ç”¨çš„ Netlify CMS åŠŸèƒ½ï¼Œå› ä¸ºä¹‹å‰å»º[æ—§ç«™åšç‰©é¦†](https://museum.berlinchan.com)æ—¶å€™ï¼Œ
å‘ç° Netlify çš„ CDN åŠ é€Ÿï¼Œåœ¨å¤§é™†è®¿é—®åè€Œè¿˜æ²¡æœ‰ GitHub Pages æœ¬èº«å¿«ï¼Œæ‰€ä»¥å†³å®šä¸ä½¿ç”¨ Netlify æœåŠ¡ã€‚

è¿˜æœ‰ Flow å’Œ Jest ä¹Ÿè¢«æˆ‘ç§»é™¤ã€‚èµ·åˆæƒ³å¤šç”¨ç”¨æµ‹è¯•æ¡†æ¶å’Œé™æ€æ£€æŸ¥çš„ï¼Œä½†å‘ç°é¢‘ç¹å˜åŠ¨ä¸­å†™è¿™äº›æµ‹è¯•å’Œæ£€æŸ¥å¤ªè¿‡ç¹çã€‚

UI æ–¹æ¡ˆå¼•å…¥ [Material-UI](https://material-ui.com/)è¿›è¡Œæ”¹é€ ï¼Œå¹¶å½¢æˆæœ€ç»ˆçš„æ ·å­ã€‚

## å°†æ—§æ–‡ç« å¯¼å…¥åˆ° Gatsby æ–°ç«™
å¾—ç›Šäº Gatsby çš„

> Pull data from anywhere

Wordpress çš„æ—§æ–‡ç« å¾ˆå®¹æ˜“æ¥å…¥ GraphQL å¹¶ä¸ºç”Ÿæˆå™¨æä¾›æ•°æ®ï¼Œä½¿ç”¨ `gatsby-source-wordpress` å°±è¡Œäº†ï¼Œ
å®‰è£…å’Œé…ç½®è§å®˜æ–¹æ•™ç¨‹ [WordPress Source Plugin Tutorial](https://www.gatsbyjs.org/tutorial/wordpress-source-plugin-tutorial/)ã€‚

ç„¶åæˆ‘ç”¨æ¥å…¥çš„ Wordpress æ—§ç«™æ•°æ®ç”Ÿæˆäº†ç›®å½•åŠæ–‡ç« ï¼Œå¹¶åœ¨æ–‡ç« ä¸­æ·»åŠ æŒ‡å‘åŸå­˜æ¡£æ—§é¡µé¢çš„é“¾æ¥ï¼Œåƒä¸‹å›¾è¿™æ ·ï¼š
![archived-blog-tips](../../static/media/2019/08/archived-blog-tips.png)

ä½†è¿™æ ·æ¥å…¥ Wordpress æ•°æ®æœ‰ä¸ªé—®é¢˜ï¼Œæ¯æ¬¡æ›´æ–°ç”Ÿæˆç½‘ç«™éƒ½éœ€è¦è¿è¡Œ Wordpress REST APIã€‚æˆ‘çš„è§£å†³åŠæ³•æ˜¯å°† GraphQL æŸ¥è¯¢ç»“æœå­˜ä¸º JSON æ–‡ä»¶ï¼Œ
è€Œåç”¨ `gatsby-transformer-json` æ¥å…¥åˆ° GraphQLï¼Œå°±å¯ä»¥å®Œå…¨è„±ç¦»å¼€ Wordpress è¿è¡Œäº†ã€‚æˆ‘å­˜ä¸ºçš„ JSON æ–‡ä»¶å¦‚ä¸‹å›¾ï¼š
![archived-blog-json](../../static/media/2019/08/archived-blog-json.png)

## æ·»åŠ è¯„è®ºåŠŸèƒ½
è€ƒè™‘è¿‡ Gitalk/Disqus/å¤šè¯´/Firebase/é‡ç‹—ï¼ŒFirebase/Disqus å¤§é™†ç”¨ä¸äº†ï¼ŒGitalk åªèƒ½ç”¨ GitHub è´¦å·ç™»é™†ï¼Œ
å¤šè¯´å·²ç»æ— æ³•è¯´ğŸ¤ï¼Œé‡ç‹—å·²åœæ­¢è¿è¥ã€‚

æƒè¡¡åè¿˜æ˜¯é€‰æ‹©ä¸šç•Œé¢†å…ˆçš„ Disqusï¼Œåæ­£è¿™åšå®¢ç«™è®¿é—®çš„äººå°‘ğŸ¤£

## å…¶å®ƒçš„å°è¯•
æœ€å¼€å§‹å°è¯•ç›´æ¥å°† WP2Static ç”Ÿæˆçš„é™æ€ HTML é¡µæ”¾åˆ° Gatsby é¡¹ç›®çš„ `/static` ç›®å½•ä¸‹ï¼Œå› ä¸ºè¯¥ç›®å½•çš„å†…å®¹ä¼šä¸ç»å¤„ç†çš„ç›´æ¥æ‹·è´è‡³ç”Ÿæˆç›®å½•ã€‚
ç„¶åç”¨æ–°ç«™ Gatsby ç”Ÿæˆç›®å½•æŒ‡å‘è¿™äº›æ—§æ–‡ç« ï¼Œä½†è¿™äº›é“¾æ¥å°±ä¸åœ¨ SPA çš„æ²»ä¸‹ï¼Œå‰ç«¯è·¯ç”±ä¼š 404 æ‰¾ä¸åˆ°é¡µé¢ã€‚

æˆ–è€…ä½¿ç”¨ `gatsby-plugin-meta-redirect` `gatsby-plugin-client-side-redirect` ç”Ÿæˆä¸€ä¸ª redirect çš„ç©ºé¡µé¢ç”¨äºé‡å®šå‘ã€‚
ä½†è¿™æ ·æ—¢ç„¶ç”Ÿæˆâ€œç©ºé¡µé¢â€äº†ï¼Œè¿˜ä¸å¦‚ç”Ÿæˆä¸€ç¯‡å®Œæ•´çš„æ–‡ç« é¡µï¼Œè¿˜èƒ½åˆ©ç”¨ä¸Š PWA çš„ pre-fetch ç‰¹æ€§ã€‚

æˆ‘åœ¨è¿™äº›å°è¯•ä¸Šè´¹äº†å¾ˆå¤šæ—¶é—´ã€‚

## GitHub ä¸Šå¥½ç”¨çš„å·¥å…·
Gatsby æ˜¯ä¸€ä¸ªå¿«é€Ÿå‘å±•ä¸­çš„æ–°æ¡†æ¶ï¼Œå°†ä»£ç æ‰˜ç®¡åœ¨ GitHub ä¸Šæ—¶ï¼Œç”¨å¸‚åœºä¸­çš„ [Dependabot Preview](https://github.com/marketplace/dependabot-preview)
æˆ–è€… [Renovate](https://github.com/marketplace/renovate)ï¼Œèƒ½å¾ˆå¥½å¸®æˆ‘ä»¬æ›´æ–° npm ä¾èµ–ã€‚
[ä½¿ç”¨ ImgBot è‡ªåŠ¨ä¸º Github Pages é¡¹ç›®ä¼˜åŒ–å›¾ç‰‡](https://www.berlinchan.com/2019/08/imgBot-optimize-image-asset-for-github-pages-project)ï¼Œ
è¿˜æœ‰æŒç»­é›†æˆå·¥å…· [Travis CI](https://github.com/marketplace/travis-ci)ã€‚

è¿™äº›å¸‚åœºä¸­çš„å·¥å…·è®¾è®¡çš„ç®€å•æ˜“ç”¨ï¼Œè‡ªåŠ¨åŒ–çš„å·¥ä½œä¸ºæˆ‘èŠ‚çœäº†å¤§é‡æ—¶é—´ã€‚

## æ€»ç»“
Gatsby æ˜¯ä¸ªéå¸¸ä¸é”™çš„æ¡†æ¶ï¼Œæ¡†æ¶è‡ªèº«å’Œæ’ä»¶è½»æ¾å®ç° SPA PWA ç‰¹æ€§ï¼Œé™æ€é¡µå…ˆå¤©çš„ SEO ä¼˜åŒ–ã€‚
æˆ‘çš„è¿ç§»å·¥ä½œå¤§æ¦‚ç”¨äº†ä¸€ä¸ªæœˆä¸šä½™æ—¶é—´ï¼Œæ–°ç«™éƒ¨ç½²åœ¨ GitHub Pages ä¸Šï¼Œç”¨é˜¿é‡Œäº‘ CDN åŠ é€Ÿï¼Œè®¿é—®é€Ÿåº¦ä½“éªŒè¾ƒä»¥å‰å¿«äº†ä¸å°‘ï¼ŒLighthouse è¯„åˆ†å¦‚ä¸‹ï¼Œå¹¶è¿˜å¯è¿›ä¸€æ­¥æ”¹å–„ï¼š
![lighthouse-audit](../../static/media/2019/08/lighthouse-audit.png)
